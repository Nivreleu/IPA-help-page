<article class="criterion-card">
  <h2 class="criterion-card__title">{{ criterion?.name }}</h2>
  <p class="criterion-card__desc">{{ criterion?.description }}</p>

  <div class="criterion-card__grade-row">
    <span class="criterion-card__grade-label">Erreicht:</span>

    <button
      type="button"
      class="criterion-card__grade"
      (click)="setGuetestufe('G1')"
      [class.active]="getGuetestufe() === 'G1'"
    >
      G1: 1P
    </button>

    <button
      type="button"
      class="criterion-card__grade"
      (click)="setGuetestufe('G2')"
      [class.active]="getGuetestufe() === 'G2'"
    >
      G2: 2P
    </button>

    <button
      type="button"
      class="criterion-card__grade"
      (click)="setGuetestufe('G3')"
      [class.active]="getGuetestufe() === 'G3'"
    >
      G3: 3P
    </button>

    <button
      type="button"
      class="criterion-card__grade"
      (click)="setGuetestufe('NZ')"
      [class.active]="getGuetestufe() === 'NZ' || !getGuetestufe()"
    >
      Nicht gesetzt
    </button>

    @if (showGradeHint()) {
      <span class="criterion-card__grade-current">
    Gespeichert: {{ getGuetestufe() }}
  </span>
    }

  </div>

  <div class="criterion-card__divider"></div>

  <ul class="criterion-card__req-list">
    @for (req of criterion?.anforderungen ?? []; track req.id) {
      <li class="criterion-card__req-item">
        <label class="criterion-card__req-label">
          <input
            class="criterion-card__checkbox"
            type="checkbox"
            [ngModel]="isReqChecked(req.id)"
            (ngModelChange)="toggleReq(req.id, $event)"
          >
          <span class="criterion-card__req-text">
            <span class="criterion-card__req-number">{{ req.number }}.</span>
            {{ req.text }}
          </span>
        </label>
      </li>
    }
  </ul>

  <div>
    <textarea
      class="criterion-card__comment"
      placeholder="Kommentar"
      [(ngModel)]="comment"
    ></textarea>

    <button
      class="criterion-card__submit"
      (click)="saveComment()"
      type="button"
    >
      Speichern
    </button>

    @if (showSuccess()) {
      <div class="criterion-card__success">Kommentar gespeichert</div>
    }
  </div>
</article>
